<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Haxinator 2000 - PHP Security Scan</title>
    <link href="/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/css/theme.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/bootstrap-icons/bootstrap-icons.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #65ddb7 0%, #3a7cbd 100%);
            font-family: "Segoe UI", Arial, sans-serif;
            min-height: 100vh;
            margin: 0;
        }
        .container {
            padding: 2rem 1rem;
        }
        .config-card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            max-width: 1200px;
            margin: 0 auto;
        }
        .config-section {
            border-bottom: 1px solid #e0e7ef;
            padding: 1rem;
        }
        .config-section:last-child {
            border-bottom: none;
        }
        .config-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1a365d;
            margin-bottom: 0.75rem;
            letter-spacing: 0.5px;
        }
        .config-description {
            color: #64748b;
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
        }
        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .nm-table {
            margin: 0;
            width: 100%;
            border-collapse: collapse;
        }
        .nm-table th, .nm-table td {
            padding: 0.4rem 0.6rem;
            font-size: 0.85rem;
            text-align: left;
            border-right: 1px solid #e0e7ef;
        }
        .nm-table th:last-child, .nm-table td:last-child {
            border-right: none;
        }
        .nm-table th {
            position: sticky;
            top: 0;
            background: #e9f1fb;
            z-index: 1;
        }
        .nm-table td:not(:first-child) {
            text-align: center;
        }
        .nm-table tbody tr:nth-child(even) {
            background: #f8fafc;
        }
        .nm-table tbody tr:hover {
            background: #f1f5f9;
        }
        .context-code {
            background: #f8fafc;
            border: 1px solid #cbd5e1;
            border-radius: 4px;
            padding: 0.75rem;
            font-family: monospace;
            font-size: 0.8rem;
            white-space: pre-wrap;
            margin-top: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        .occurrence-item {
            margin-bottom: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #e0e7ef;
        }
        .occurrence-item:last-child {
            border-bottom: none;
        }
        .page-header {
            text-align: center;
            color: #ffffff;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .report-date {
            text-align: center;
            color: #ffffff;
            font-size: 1rem;
            margin-bottom: 1.5rem;
            opacity: 0.8;
        }
        .footer {
            text-align: center;
            color: #ffffff;
            font-size: 0.8rem;
            margin-top: 2rem;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="page-header">Haxinator 2000 - PHP Security Scan</h2>
        <div class="report-date">Generated on Sunday, May 18, 2025 at 05:12 PM </div>

        <div class="config-card">
            <!-- Statistics Section -->
            <div class="config-section">
                <div class="config-title">Scan Statistics</div>
                <div class="config-description">Overview of dangerous PHP function calls detected.</div>
                <p><strong>Total dangerous function calls:</strong> 91</p>
                <p><strong>Breakdown by function:</strong></p>
                <ul>
                    <li>curl_exec: 2</li><li>exec: 50</li><li>file_get_contents: 6</li><li>file_put_contents: 2</li><li>fsockopen: 3</li><li>getenv: 2</li><li>ini_get: 1</li><li>ini_set: 8</li><li>mkdir: 3</li><li>move_uploaded_file: 3</li><li>ob_start: 2</li><li>popen: 1</li><li>preg_replace: 1</li><li>proc_open: 3</li><li>shell_exec: 1</li><li>unlink: 3</li>
                </ul>
            </div>

            <!-- Details Section -->
            <div class="config-section">
                <div class="config-title">Details of Occurrences</div>
                <div class="config-description">Specific instances of dangerous function calls with context.</div>
                <div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/configure.php, <strong>Line:</strong> 754, <strong>Function:</strong> file_get_contents</p>
    <div class="context-code">                    &lt;button type=&quot;button&quot; class=&quot;btn-close&quot; data-bs-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;&lt;/button&gt;<br>                &lt;/div&gt;<br>                &lt;div class=&quot;modal-body&quot;&gt;<br>                    &lt;?php if (is_readable(&#x27;/var/www/env-secrets&#x27;)): ?&gt;<br>                        &lt;pre class=&quot;bg-light p-3 rounded&quot; style=&quot;max-height: 400px; overflow-y: auto;&quot;&gt;&lt;?php<br>                            echo htmlspecialchars(file_get_contents(&#x27;/var/www/env-secrets&#x27;));<br>                        ?&gt;&lt;/pre&gt;<br>                    &lt;?php else: ?&gt;<br>                        &lt;div class=&quot;alert alert-warning mb-0&quot;&gt;<br>                            &lt;i class=&quot;bi bi-exclamation-triangle me-2&quot;&gt;&lt;/i&gt;<br>                            No env-secrets file found.</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/ui/UI.php, <strong>Line:</strong> 18, <strong>Function:</strong> ob_start</p>
    <div class="context-code">$dns_ok = Util::dnsResolvesGoogle();<br>$ping_ok = Util::pingGoogle();  // Store result<br><br>function renderLoginPage($login_error)<br>{<br>    ob_start();<br>    ?&gt;<br>    &lt;!DOCTYPE html&gt;<br>    &lt;html lang=&quot;en&quot;&gt;<br>    &lt;head&gt;<br>      &lt;meta charset=&quot;UTF-8&quot; /&gt;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/ui/UI.php, <strong>Line:</strong> 112, <strong>Function:</strong> ob_start</p>
    <div class="context-code"><br>function renderMainPage($message, $error, $wifi_list, $saved_connections, $iface_status, $active_uuids, $unique_wifi_list, $public_ip, $dns_ok, $hostname, $tunnel_status = null)<br>{<br>    global $ping_ok;  // Add this line to make $ping_ok available inside the function<br>    global $data;<br>    ob_start();<br>    ?&gt;<br>    &lt;!DOCTYPE html&gt;<br>    &lt;html lang=&quot;en&quot;&gt;<br>    &lt;head&gt;<br>      &lt;meta charset=&quot;UTF-8&quot; /&gt;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/ui/diagnostic-status.php, <strong>Line:</strong> 13, <strong>Function:</strong> curl_exec</p>
    <div class="context-code">$ch = curl_init();<br>curl_setopt($ch, CURLOPT_URL, &#x27;https://ifconfig.me&#x27;);<br>curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);<br>curl_setopt($ch, CURLOPT_TIMEOUT, 5);<br>curl_setopt($ch, CURLOPT_USERAGENT, &#x27;curl&#x27;);<br>$ip = trim(curl_exec($ch));<br>$curl_errno = curl_errno($ch);<br>$curl_error = curl_error($ch);<br>$httpcode = curl_getinfo($ch, CURLINFO_HTTP_CODE);<br>curl_close($ch);<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/ui/diagnostic-status.php, <strong>Line:</strong> 24, <strong>Function:</strong> exec</p>
    <div class="context-code">echo &quot;IP: $ip\n&quot;;<br>echo &quot;cURL errno: $curl_errno\n&quot;;<br>echo &quot;cURL error: $curl_error\n&quot;;<br>echo &quot;HTTP code: $httpcode\n\n&quot;;<br><br>echo &quot;=== exec(&#x27;dig +short google.com&#x27;) ===\n&quot;;<br>$output = null;<br>$retval = null;<br>exec(&#x27;dig +short google.com&#x27;, $output, $retval);<br>echo &quot;Return value: $retval\n&quot;;<br>echo &quot;Output lines:\n&quot;;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/ui/diagnostic-status.php, <strong>Line:</strong> 27, <strong>Function:</strong> exec</p>
    <div class="context-code">echo &quot;HTTP code: $httpcode\n\n&quot;;<br><br>echo &quot;=== exec(&#x27;dig +short google.com&#x27;) ===\n&quot;;<br>$output = null;<br>$retval = null;<br>exec(&#x27;dig +short google.com&#x27;, $output, $retval);<br>echo &quot;Return value: $retval\n&quot;;<br>echo &quot;Output lines:\n&quot;;<br>foreach ($output as $line) {<br>    echo $line . &quot;\n&quot;;<br>}</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/ui/diagnostic-status.php, <strong>Line:</strong> 35, <strong>Function:</strong> ini_get</p>
    <div class="context-code">foreach ($output as $line) {<br>    echo $line . &quot;\n&quot;;<br>}<br><br>echo &quot;\n=== PHP Info (disabled functions) ===\n&quot;;<br>echo ini_get(&#x27;disable_functions&#x27;) . &quot;\n&quot;;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/security/SecureCommand.php, <strong>Line:</strong> 34, <strong>Function:</strong> exec</p>
    <div class="context-code"><br>        // Log the command execution (for debugging and auditing)<br>        error_log(&quot;Executing command: &quot; . $safe_command);<br><br>        // Execute the command<br>        $result = exec($safe_command, $output, $return_code);<br><br>        return $result;<br>    }<br><br>    /**</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/security/bootstrap.php, <strong>Line:</strong> 12, <strong>Function:</strong> ini_set</p>
    <div class="context-code"> */<br><br>// Check if session is already started, if not start it<br>if (session_status() === PHP_SESSION_NONE) {<br>    // Set secure session parameters<br>    ini_set(&#x27;session.cookie_httponly&#x27;, 1);<br>    if (!empty($_SERVER[&#x27;HTTPS&#x27;]) &amp;&amp; $_SERVER[&#x27;HTTPS&#x27;] !== &#x27;off&#x27;) {<br>        ini_set(&#x27;session.cookie_secure&#x27;, 1);<br>    }<br>    ini_set(&#x27;session.use_strict_mode&#x27;, 1);<br>    session_start();</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/security/bootstrap.php, <strong>Line:</strong> 14, <strong>Function:</strong> ini_set</p>
    <div class="context-code">// Check if session is already started, if not start it<br>if (session_status() === PHP_SESSION_NONE) {<br>    // Set secure session parameters<br>    ini_set(&#x27;session.cookie_httponly&#x27;, 1);<br>    if (!empty($_SERVER[&#x27;HTTPS&#x27;]) &amp;&amp; $_SERVER[&#x27;HTTPS&#x27;] !== &#x27;off&#x27;) {<br>        ini_set(&#x27;session.cookie_secure&#x27;, 1);<br>    }<br>    ini_set(&#x27;session.use_strict_mode&#x27;, 1);<br>    session_start();<br>}<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/security/bootstrap.php, <strong>Line:</strong> 16, <strong>Function:</strong> ini_set</p>
    <div class="context-code">    // Set secure session parameters<br>    ini_set(&#x27;session.cookie_httponly&#x27;, 1);<br>    if (!empty($_SERVER[&#x27;HTTPS&#x27;]) &amp;&amp; $_SERVER[&#x27;HTTPS&#x27;] !== &#x27;off&#x27;) {<br>        ini_set(&#x27;session.cookie_secure&#x27;, 1);<br>    }<br>    ini_set(&#x27;session.use_strict_mode&#x27;, 1);<br>    session_start();<br>}<br><br>// Define path to security directory<br>$securityDir = __DIR__;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 22, <strong>Function:</strong> mkdir</p>
    <div class="context-code"><br>    public function __construct()<br>    {<br>        // Ensure the data directory exists<br>        if (!is_dir(dirname($this-&gt;pid_file))) {<br>            mkdir(dirname($this-&gt;pid_file), 0750, true);<br>        }<br>    }<br><br>    /**<br>     * Validate SSH connection inputs</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 74, <strong>Function:</strong> file_put_contents</p>
    <div class="context-code">    public function logMessage($level, $message)<br>    {<br>        $timestamp = date(&#x27;Y-m-d H:i:s&#x27;);<br>        $pid = getmypid();<br>        $log_entry = &quot;[$timestamp] [PID:$pid] [$level] $message&quot;;<br>        file_put_contents($this-&gt;log_file, &quot;$log_entry\n&quot;, FILE_APPEND);<br>        error_log($log_entry, 3, $this-&gt;log_file);<br>    }<br><br>    /**<br>     * Check if tunnel is running</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 90, <strong>Function:</strong> file_get_contents</p>
    <div class="context-code">        if (!file_exists($this-&gt;pid_file)) {<br>            $this-&gt;logMessage(&#x27;DEBUG&#x27;, &quot;PID file {$this-&gt;pid_file} does not exist&quot;);<br>            return false;<br>        }<br><br>        $pid = trim(file_get_contents($this-&gt;pid_file));<br>        if (empty($pid)) {<br>            $this-&gt;logMessage(&#x27;DEBUG&#x27;, &quot;PID file {$this-&gt;pid_file} is empty&quot;);<br>            return false;<br>        }<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 103, <strong>Function:</strong> fsockopen</p>
    <div class="context-code">            $this-&gt;logMessage(&#x27;DEBUG&#x27;, &quot;Process $pid is not running&quot;);<br>            return false;<br>        }<br><br>        // Check if port 8080 is in use using native PHP socket functions<br>        $socket = @fsockopen(&#x27;127.0.0.1&#x27;, 8080, $errno, $errstr, 1);<br>        if ($socket) {<br>            fclose($socket);<br>            $this-&gt;logMessage(&#x27;DEBUG&#x27;, &quot;Port 8080 is listening - tunnel is active&quot;);<br>            return true;<br>        }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 148, <strong>Function:</strong> file_get_contents</p>
    <div class="context-code">            $perms = substr(sprintf(&#x27;%o&#x27;, fileperms($this-&gt;ssh_key)), -4);<br>            $debug_info[] = &quot;SSH key permissions: $perms&quot;;<br>            $this-&gt;logMessage(&#x27;DEBUG&#x27;, $debug_info[count($debug_info)-1]);<br><br>            // Validate key format<br>            $key_content = file_get_contents($this-&gt;ssh_key);<br>            if (strpos($key_content, &#x27;-----BEGIN&#x27;) === false || strpos($key_content, &#x27;-----END&#x27;) === false) {<br>                $debug_info[] = &quot;Warning: SSH key appears to be invalid or corrupted&quot;;<br>                $this-&gt;logMessage(&#x27;WARNING&#x27;, $debug_info[count($debug_info)-1]);<br>            }<br>        }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 168, <strong>Function:</strong> getenv</p>
    <div class="context-code">            $this-&gt;logMessage(&#x27;DEBUG&#x27;, $debug_info[count($debug_info)-1]);<br>        }<br><br>        // Check environment<br>        $env_info = [<br>            &#x27;HOME&#x27; =&gt; getenv(&#x27;HOME&#x27;) ?: &#x27;not set&#x27;,<br>            &#x27;USER&#x27; =&gt; posix_getpwuid(posix_geteuid())[&#x27;name&#x27;],<br>            &#x27;SSH_AUTH_SOCK&#x27; =&gt; getenv(&#x27;SSH_AUTH_SOCK&#x27;) ?: &#x27;not set&#x27;<br>        ];<br>        foreach ($env_info as $key =&gt; $value) {<br>            $debug_info[] = &quot;$key environment: $value&quot;;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 170, <strong>Function:</strong> getenv</p>
    <div class="context-code"><br>        // Check environment<br>        $env_info = [<br>            &#x27;HOME&#x27; =&gt; getenv(&#x27;HOME&#x27;) ?: &#x27;not set&#x27;,<br>            &#x27;USER&#x27; =&gt; posix_getpwuid(posix_geteuid())[&#x27;name&#x27;],<br>            &#x27;SSH_AUTH_SOCK&#x27; =&gt; getenv(&#x27;SSH_AUTH_SOCK&#x27;) ?: &#x27;not set&#x27;<br>        ];<br>        foreach ($env_info as $key =&gt; $value) {<br>            $debug_info[] = &quot;$key environment: $value&quot;;<br>            $this-&gt;logMessage(&#x27;DEBUG&#x27;, &quot;$key = $value&quot;);<br>        }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 191, <strong>Function:</strong> proc_open</p>
    <div class="context-code">               &quot; -o ConnectTimeout=5&quot; .<br>               &quot; -o StrictHostKeyChecking=no&quot; .<br>               &quot; -o UserKnownHostsFile=&quot; . escapeshellarg($this-&gt;known_hosts) .<br>               &quot; &quot; . $remote_host . &quot; true&quot;;<br><br>        $process = proc_open($cmd, $descriptorspec, $pipes);<br>        $return_var = -1;<br>        $output_str = &#x27;&#x27;;<br><br>        if (is_resource($process)) {<br>            // Close stdin as we don&#x27;t need it</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 314, <strong>Function:</strong> proc_open</p>
    <div class="context-code">        $cmd = &quot;ssh -i &quot; . escapeshellarg($this-&gt;ssh_key) .<br>               &quot; -o UserKnownHostsFile=&quot; . escapeshellarg($this-&gt;known_hosts) .<br>               &quot; -o StrictHostKeyChecking=no&quot; .<br>               &quot; -N -D &quot; . escapeshellarg($this-&gt;local_bind) .<br>               &quot; &quot; . $remote_host;<br>        $process = proc_open($cmd, $descriptorspec, $pipes);<br><br>        if (is_resource($process)) {<br>            // Get process ID<br>            $status = proc_get_status($process);<br>            $pid = $status[&#x27;pid&#x27;];</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 331, <strong>Function:</strong> file_put_contents</p>
    <div class="context-code">            usleep(500000); // 0.5 seconds<br><br>            // Check if process is still running<br>            $status = proc_get_status($process);<br>            if ($status[&#x27;running&#x27;]) {<br>                file_put_contents($this-&gt;pid_file, $pid);<br>                $this-&gt;logMessage(&#x27;DEBUG&#x27;, &quot;Wrote PID $pid to {$this-&gt;pid_file}&quot;);<br><br>                // Close pipes but keep process running<br>                fclose($pipes[0]);<br>                fclose($pipes[1]);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 378, <strong>Function:</strong> file_get_contents</p>
    <div class="context-code">            $this-&gt;logMessage(&#x27;WARNING&#x27;, &quot;Tunnel not running&quot;);<br>            return &quot;Tunnel is not running.&quot;;<br>        }<br><br>        // First try to kill the process in the PID file<br>        $pid = trim(file_get_contents($this-&gt;pid_file));<br>        $this-&gt;logMessage(&#x27;DEBUG&#x27;, &quot;Stopping process with PID $pid&quot;);<br><br>        // Try SIGTERM first (signal 15)<br>        if (posix_kill($pid, 15)) {<br>            // Wait briefly to see if the process terminates</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 396, <strong>Function:</strong> exec</p>
    <div class="context-code">        }<br><br>        // Kill any remaining SSH tunnel processes<br>        $output = [];<br>        $return_var = 0;<br>        exec(&quot;pkill -f &#x27;ssh.*-D 0.0.0.0:8080&#x27;&quot;, $output, $return_var);<br><br>        // Clean up PID file<br>        if (file_exists($this-&gt;pid_file)) {<br>            unlink($this-&gt;pid_file);<br>        }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 400, <strong>Function:</strong> unlink</p>
    <div class="context-code">        $return_var = 0;<br>        exec(&quot;pkill -f &#x27;ssh.*-D 0.0.0.0:8080&#x27;&quot;, $output, $return_var);<br><br>        // Clean up PID file<br>        if (file_exists($this-&gt;pid_file)) {<br>            unlink($this-&gt;pid_file);<br>        }<br><br>        // Verify port 8080 is no longer in use<br>        $socket = @fsockopen(&#x27;127.0.0.1&#x27;, 8080, $errno, $errstr, 1);<br>        if ($socket) {</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 404, <strong>Function:</strong> fsockopen</p>
    <div class="context-code">        if (file_exists($this-&gt;pid_file)) {<br>            unlink($this-&gt;pid_file);<br>        }<br><br>        // Verify port 8080 is no longer in use<br>        $socket = @fsockopen(&#x27;127.0.0.1&#x27;, 8080, $errno, $errstr, 1);<br>        if ($socket) {<br>            fclose($socket);<br>            $error = &quot;Failed to stop tunnel completely - port 8080 is still in use&quot;;<br>            $this-&gt;logMessage(&#x27;ERROR&#x27;, $error);<br>            return $error;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 446, <strong>Function:</strong> fsockopen</p>
    <div class="context-code">    {<br>        $status = $this-&gt;getTunnelStatus();<br>        $debug = &#x27;&#x27;;<br><br>        // Check if port 8080 is listening<br>        $socket = @fsockopen(&#x27;127.0.0.1&#x27;, 8080, $errno, $errstr, 1);<br>        $port_listening = false;<br>        if ($socket) {<br>            fclose($socket);<br>            $port_listening = true;<br>        }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 485, <strong>Function:</strong> mkdir</p>
    <div class="context-code"><br>        // Ensure .ssh directory exists with proper permissions<br>        $ssh_dir = dirname($this-&gt;ssh_key);<br>        if (!is_dir($ssh_dir)) {<br>            $this-&gt;logMessage(&#x27;DEBUG&#x27;, &quot;Creating SSH directory: $ssh_dir&quot;);<br>            if (!mkdir($ssh_dir, 0700, true)) {<br>                $error = &quot;Failed to create SSH directory: &quot; . error_get_last()[&#x27;message&#x27;];<br>                $this-&gt;logMessage(&#x27;ERROR&#x27;, $error);<br>                return [&#x27;status&#x27; =&gt; false, &#x27;message&#x27; =&gt; $error];<br>            }<br>        } else {</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 507, <strong>Function:</strong> unlink</p>
    <div class="context-code">        $dir_group = posix_getgrgid(filegroup($ssh_dir))[&#x27;name&#x27;];<br>        $this-&gt;logMessage(&#x27;DEBUG&#x27;, &quot;SSH directory permissions: $dir_perms, owner: $dir_owner, group: $dir_group&quot;);<br><br>        // Remove existing keys if they exist<br>        if (file_exists($this-&gt;ssh_key)) {<br>            unlink($this-&gt;ssh_key);<br>        }<br>        if (file_exists($this-&gt;ssh_key . &#x27;.pub&#x27;)) {<br>            unlink($this-&gt;ssh_key . &#x27;.pub&#x27;);<br>        }<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 510, <strong>Function:</strong> unlink</p>
    <div class="context-code">        // Remove existing keys if they exist<br>        if (file_exists($this-&gt;ssh_key)) {<br>            unlink($this-&gt;ssh_key);<br>        }<br>        if (file_exists($this-&gt;ssh_key . &#x27;.pub&#x27;)) {<br>            unlink($this-&gt;ssh_key . &#x27;.pub&#x27;);<br>        }<br><br>        // Generate new SSH key pair with no passphrase<br>        $output = [];<br>        $return_var = 0;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 519, <strong>Function:</strong> exec</p>
    <div class="context-code">        $output = [];<br>        $return_var = 0;<br>        $command = &quot;ssh-keygen -t rsa -b 4096 -f &quot; . escapeshellarg($this-&gt;ssh_key) . &quot; -N &#x27;&#x27; -C &#x27;haxinator@&quot; . gethostname() . &quot;&#x27; 2&gt;&amp;1&quot;;<br><br>        $this-&gt;logMessage(&#x27;DEBUG&#x27;, &quot;Executing command: $command&quot;);<br>        exec($command, $output, $return_var);<br>        $output_str = implode(&quot;\n&quot;, $output);<br><br>        if ($return_var !== 0) {<br>            $error = &quot;Failed to regenerate SSH keys (return code $return_var): $output_str&quot;;<br>            $this-&gt;logMessage(&#x27;ERROR&#x27;, $error);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php, <strong>Line:</strong> 573, <strong>Function:</strong> file_get_contents</p>
    <div class="context-code">                &#x27;message&#x27; =&gt; &#x27;No public key found. Please generate SSH keys first.&#x27;,<br>                &#x27;key&#x27; =&gt; &#x27;&#x27;<br>            ];<br>        }<br><br>        $key_content = file_get_contents($pub_key_path);<br><br>        return [<br>            &#x27;status&#x27; =&gt; true,<br>            &#x27;message&#x27; =&gt; &#x27;Public key retrieved successfully&#x27;,<br>            &#x27;key&#x27; =&gt; $key_content</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 199, <strong>Function:</strong> exec</p>
    <div class="context-code">    }<br><br>    public function configureInterface($iface, $mode, $postData)<br>    {<br>        $connectionName = &#x27;&#x27;;<br>        exec(&quot;nmcli -t -f NAME,DEVICE connection show&quot;, $connLines);<br>        foreach ($connLines as $line) {<br>            list($connName, $dev) = explode(&#x27;:&#x27;, $line);<br>            if ($dev === $iface) {<br>                $connectionName = $connName;<br>                break;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 209, <strong>Function:</strong> exec</p>
    <div class="context-code">                break;<br>            }<br>        }<br>        if ($connectionName === &#x27;&#x27; &amp;&amp; in_array($iface, [&#x27;eth0&#x27;, &#x27;usb0&#x27;])) {<br>            $connectionName = $iface;<br>            exec(&quot;nmcli connection add type ethernet ifname $iface con-name $iface autoconnect yes 2&gt;&amp;1&quot;);<br>        }<br>        if ($connectionName === &#x27;&#x27;) {<br>            return [<br>                &#x27;error&#x27;   =&gt; &quot;No connection profile found for interface &quot; . strtoupper($iface) . &quot;.&quot;,<br>                &#x27;message&#x27; =&gt; &#x27;&#x27;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 220, <strong>Function:</strong> exec</p>
    <div class="context-code">            ];<br>        }<br><br>        $conn_arg = escapeshellarg($connectionName);<br>        if ($mode === &#x27;dhcp&#x27;) {<br>            exec(&quot;nmcli connection modify $conn_arg ipv4.method auto ipv4.addresses \&quot;\&quot; ipv4.gateway \&quot;\&quot; ipv4.dns \&quot;\&quot;&quot;);<br>            exec(&quot;nmcli connection down $conn_arg&quot;, $outDown, $retDown);<br>            exec(&quot;nmcli connection up $conn_arg&quot;, $outUp, $retUp);<br>            return [<br>                &#x27;message&#x27; =&gt; ($retDown === 0 &amp;&amp; $retUp === 0)<br>                    ? strtoupper($iface) . &quot; set to DHCP (automatic IP).&quot;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 221, <strong>Function:</strong> exec</p>
    <div class="context-code">        }<br><br>        $conn_arg = escapeshellarg($connectionName);<br>        if ($mode === &#x27;dhcp&#x27;) {<br>            exec(&quot;nmcli connection modify $conn_arg ipv4.method auto ipv4.addresses \&quot;\&quot; ipv4.gateway \&quot;\&quot; ipv4.dns \&quot;\&quot;&quot;);<br>            exec(&quot;nmcli connection down $conn_arg&quot;, $outDown, $retDown);<br>            exec(&quot;nmcli connection up $conn_arg&quot;, $outUp, $retUp);<br>            return [<br>                &#x27;message&#x27; =&gt; ($retDown === 0 &amp;&amp; $retUp === 0)<br>                    ? strtoupper($iface) . &quot; set to DHCP (automatic IP).&quot;<br>                    : &#x27;&#x27;,</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 222, <strong>Function:</strong> exec</p>
    <div class="context-code"><br>        $conn_arg = escapeshellarg($connectionName);<br>        if ($mode === &#x27;dhcp&#x27;) {<br>            exec(&quot;nmcli connection modify $conn_arg ipv4.method auto ipv4.addresses \&quot;\&quot; ipv4.gateway \&quot;\&quot; ipv4.dns \&quot;\&quot;&quot;);<br>            exec(&quot;nmcli connection down $conn_arg&quot;, $outDown, $retDown);<br>            exec(&quot;nmcli connection up $conn_arg&quot;, $outUp, $retUp);<br>            return [<br>                &#x27;message&#x27; =&gt; ($retDown === 0 &amp;&amp; $retUp === 0)<br>                    ? strtoupper($iface) . &quot; set to DHCP (automatic IP).&quot;<br>                    : &#x27;&#x27;,<br>                &#x27;error&#x27; =&gt; ($retDown !== 0 || $retUp !== 0)</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 290, <strong>Function:</strong> exec</p>
    <div class="context-code">            $dns_arg  = escapeshellarg($dns);<br><br>            $cmdMod = &quot;nmcli connection modify $conn_arg &quot;<br>                    . &quot;ipv4.method manual ipv4.addresses $addr_arg &quot;<br>                    . &quot;ipv4.gateway $gw_arg ipv4.dns $dns_arg&quot;;<br>            exec(&quot;$cmdMod 2&gt;&amp;1&quot;, $out1, $ret1);<br><br>            if ($ret1 === 0) {<br>                exec(&quot;nmcli connection down $conn_arg&quot;, $outDown, $retDown);<br>                exec(&quot;nmcli connection up   $conn_arg&quot;, $outUp, $retUp);<br>                if ($retDown === 0 &amp;&amp; $retUp === 0) {</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 293, <strong>Function:</strong> exec</p>
    <div class="context-code">                    . &quot;ipv4.method manual ipv4.addresses $addr_arg &quot;<br>                    . &quot;ipv4.gateway $gw_arg ipv4.dns $dns_arg&quot;;<br>            exec(&quot;$cmdMod 2&gt;&amp;1&quot;, $out1, $ret1);<br><br>            if ($ret1 === 0) {<br>                exec(&quot;nmcli connection down $conn_arg&quot;, $outDown, $retDown);<br>                exec(&quot;nmcli connection up   $conn_arg&quot;, $outUp, $retUp);<br>                if ($retDown === 0 &amp;&amp; $retUp === 0) {<br>                    return [<br>                        &#x27;message&#x27; =&gt; strtoupper($iface) . &quot; configured with static IP $ip.&quot;,<br>                        &#x27;error&#x27;   =&gt; &#x27;&#x27;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 294, <strong>Function:</strong> exec</p>
    <div class="context-code">                    . &quot;ipv4.gateway $gw_arg ipv4.dns $dns_arg&quot;;<br>            exec(&quot;$cmdMod 2&gt;&amp;1&quot;, $out1, $ret1);<br><br>            if ($ret1 === 0) {<br>                exec(&quot;nmcli connection down $conn_arg&quot;, $outDown, $retDown);<br>                exec(&quot;nmcli connection up   $conn_arg&quot;, $outUp, $retUp);<br>                if ($retDown === 0 &amp;&amp; $retUp === 0) {<br>                    return [<br>                        &#x27;message&#x27; =&gt; strtoupper($iface) . &quot; configured with static IP $ip.&quot;,<br>                        &#x27;error&#x27;   =&gt; &#x27;&#x27;<br>                    ];</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 322, <strong>Function:</strong> exec</p>
    <div class="context-code">        $escaped = escapeshellarg($uuid);<br>        $details = [];<br>        $raw = [];<br><br>        // Get all connection info<br>        exec(&quot;nmcli -t connection show uuid $escaped&quot;, $out);<br>        foreach ($out as $line) {<br>            $parts = explode(&#x27;:&#x27;, $line, 2);<br>            if (count($parts) === 2) {<br>                $key = trim($parts[0]);<br>                $value = trim($parts[1]);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 456, <strong>Function:</strong> exec</p>
    <div class="context-code">            }<br>        }<br><br>        // Execute all commands<br>        foreach ($commands as $cmd) {<br>            exec($cmd . &quot; 2&gt;&amp;1&quot;, $out, $ret);<br>            if ($ret !== 0) {<br>                $errors[] = implode(&quot;\n&quot;, $out);<br>            }<br>        }<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 464, <strong>Function:</strong> exec</p>
    <div class="context-code">            }<br>        }<br><br>        if (empty($errors)) {<br>            // Restart the connection if it&#x27;s active<br>            exec(&quot;nmcli -t -f NAME,DEVICE connection show --active | grep -q \&quot;$escaped\&quot;&quot;, $out, $ret);<br>            if ($ret === 0) {<br>                exec(&quot;nmcli connection down uuid $escaped &amp;&amp; nmcli connection up uuid $escaped 2&gt;&amp;1&quot;, $out, $ret);<br>                if ($ret !== 0) {<br>                    $errors[] = &quot;Connection updated but failed to restart: &quot; . implode(&quot;\n&quot;, $out);<br>                }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php, <strong>Line:</strong> 466, <strong>Function:</strong> exec</p>
    <div class="context-code"><br>        if (empty($errors)) {<br>            // Restart the connection if it&#x27;s active<br>            exec(&quot;nmcli -t -f NAME,DEVICE connection show --active | grep -q \&quot;$escaped\&quot;&quot;, $out, $ret);<br>            if ($ret === 0) {<br>                exec(&quot;nmcli connection down uuid $escaped &amp;&amp; nmcli connection up uuid $escaped 2&gt;&amp;1&quot;, $out, $ret);<br>                if ($ret !== 0) {<br>                    $errors[] = &quot;Connection updated but failed to restart: &quot; . implode(&quot;\n&quot;, $out);<br>                }<br>            }<br>        }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 7, <strong>Function:</strong> ini_set</p>
    <div class="context-code">// Include security framework<br>require_once __DIR__ . &#x27;/../security/bootstrap.php&#x27;;<br><br>// Strict error reporting<br>error_reporting(E_ALL);<br>ini_set(&#x27;display_errors&#x27;, 0);<br><br>// Authentication check<br>if (!isset($_SESSION[&#x27;logged_in&#x27;]) || !$_SESSION[&#x27;logged_in&#x27;]) {<br>    http_response_code(403);<br>    die(json_encode([&#x27;error&#x27; =&gt; &#x27;Unauthorized&#x27;]));</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 44, <strong>Function:</strong> exec</p>
    <div class="context-code">    if (isset($env[&#x27;VPN_USER&#x27;]) &amp;&amp; isset($env[&#x27;VPN_PASS&#x27;])) {<br>        if (!is_readable(&#x27;/var/www/openvpn-udp.ovpn&#x27;)) {<br>            $results[&#x27;warnings&#x27;][] = &#x27;OpenVPN credentials found but no configuration file present. Please upload the VPN configuration file.&#x27;;<br>        } else {<br>            // Delete existing connection if present<br>            exec(&#x27;nmcli connection delete openvpn-udp 2&gt;/dev/null&#x27;);<br><br>            // Import and configure VPN<br>            $output = [];<br>            $retval = 0;<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 50, <strong>Function:</strong> exec</p>
    <div class="context-code"><br>            // Import and configure VPN<br>            $output = [];<br>            $retval = 0;<br><br>            exec(&#x27;nmcli connection import type openvpn file /var/www/openvpn-udp.ovpn&#x27;, $output, $retval);<br>            if ($retval !== 0) {<br>                throw new Exception(&#x27;Failed to import OpenVPN configuration&#x27;);<br>            }<br><br>            exec(&#x27;nmcli connection modify openvpn-udp +vpn.data username=&quot;&#x27; . escapeshellarg($env[&#x27;VPN_USER&#x27;]) . &#x27;&quot; +vpn.data password-flags=0&#x27;, $output, $retval);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 55, <strong>Function:</strong> exec</p>
    <div class="context-code">            exec(&#x27;nmcli connection import type openvpn file /var/www/openvpn-udp.ovpn&#x27;, $output, $retval);<br>            if ($retval !== 0) {<br>                throw new Exception(&#x27;Failed to import OpenVPN configuration&#x27;);<br>            }<br><br>            exec(&#x27;nmcli connection modify openvpn-udp +vpn.data username=&quot;&#x27; . escapeshellarg($env[&#x27;VPN_USER&#x27;]) . &#x27;&quot; +vpn.data password-flags=0&#x27;, $output, $retval);<br>            if ($retval !== 0) {<br>                throw new Exception(&#x27;Failed to set OpenVPN username&#x27;);<br>            }<br><br>            exec(&#x27;nmcli connection modify openvpn-udp vpn.secrets password=&quot;&#x27; . escapeshellarg($env[&#x27;VPN_PASS&#x27;]) . &#x27;&quot;&#x27;, $output, $retval);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 60, <strong>Function:</strong> exec</p>
    <div class="context-code">            exec(&#x27;nmcli connection modify openvpn-udp +vpn.data username=&quot;&#x27; . escapeshellarg($env[&#x27;VPN_USER&#x27;]) . &#x27;&quot; +vpn.data password-flags=0&#x27;, $output, $retval);<br>            if ($retval !== 0) {<br>                throw new Exception(&#x27;Failed to set OpenVPN username&#x27;);<br>            }<br><br>            exec(&#x27;nmcli connection modify openvpn-udp vpn.secrets password=&quot;&#x27; . escapeshellarg($env[&#x27;VPN_PASS&#x27;]) . &#x27;&quot;&#x27;, $output, $retval);<br>            if ($retval !== 0) {<br>                throw new Exception(&#x27;Failed to set OpenVPN password&#x27;);<br>            }<br><br>            $results[&#x27;connections&#x27;][] = &#x27;OpenVPN connection configured successfully&#x27;;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 77, <strong>Function:</strong> exec</p>
    <div class="context-code">        $mtu = $env[&#x27;IODINE_MTU&#x27;] ?? &#x27;1400&#x27;;<br>        $lazy = $env[&#x27;IODINE_LAZY&#x27;] ?? &#x27;true&#x27;;<br>        $interval = $env[&#x27;IODINE_INTERVAL&#x27;] ?? &#x27;4&#x27;;<br><br>        // Delete existing connection if present<br>        exec(&#x27;nmcli connection delete iodine-vpn 2&gt;/dev/null&#x27;);<br><br>        // Create new connection<br>        $output = [];<br>        $retval = 0;<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 83, <strong>Function:</strong> exec</p>
    <div class="context-code"><br>        // Create new connection<br>        $output = [];<br>        $retval = 0;<br><br>        exec(&#x27;nmcli connection add type vpn ifname iodine0 con-name iodine-vpn vpn-type iodine&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to create Iodine connection&#x27;);<br>        }<br><br>        $vpnData = sprintf(&#x27;topdomain=%s,nameserver=%s,password=%s,mtu=%s,lazy-mode=%s,interval=%s&#x27;,</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 97, <strong>Function:</strong> exec</p>
    <div class="context-code">            escapeshellarg($mtu),<br>            escapeshellarg($lazy),<br>            escapeshellarg($interval)<br>        );<br><br>        exec(&#x27;nmcli connection modify iodine-vpn vpn.data &quot;&#x27; . $vpnData . &#x27;&quot;&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to configure Iodine connection&#x27;);<br>        }<br><br>        exec(&#x27;nmcli connection modify iodine-vpn vpn.secrets password=&quot;&#x27; . escapeshellarg($env[&#x27;IODINE_PASS&#x27;]) . &#x27;&quot;&#x27;, $output, $retval);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 102, <strong>Function:</strong> exec</p>
    <div class="context-code">        exec(&#x27;nmcli connection modify iodine-vpn vpn.data &quot;&#x27; . $vpnData . &#x27;&quot;&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to configure Iodine connection&#x27;);<br>        }<br><br>        exec(&#x27;nmcli connection modify iodine-vpn vpn.secrets password=&quot;&#x27; . escapeshellarg($env[&#x27;IODINE_PASS&#x27;]) . &#x27;&quot;&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to set Iodine password&#x27;);<br>        }<br><br>        $results[&#x27;connections&#x27;][] = &#x27;Iodine DNS tunnel configured successfully&#x27;;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 113, <strong>Function:</strong> exec</p>
    <div class="context-code">    }<br><br>    // Process Hans configuration<br>    if (isset($env[&#x27;HANS_SERVER&#x27;]) &amp;&amp; isset($env[&#x27;HANS_PASSWORD&#x27;])) {<br>        // Delete existing connection if present<br>        exec(&#x27;nmcli connection delete hans-icmp-vpn 2&gt;/dev/null&#x27;);<br><br>        // Create new connection<br>        $output = [];<br>        $retval = 0;<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 119, <strong>Function:</strong> exec</p>
    <div class="context-code"><br>        // Create new connection<br>        $output = [];<br>        $retval = 0;<br><br>        exec(&#x27;nmcli connection add type vpn con-name hans-icmp-vpn ifname tun0 vpn-type org.freedesktop.NetworkManager.hans&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to create Hans connection&#x27;);<br>        }<br><br>        exec(&#x27;nmcli connection modify hans-icmp-vpn vpn.data &quot;server=&#x27; . escapeshellarg($env[&#x27;HANS_SERVER&#x27;]) . &#x27;,password=&#x27; . escapeshellarg($env[&#x27;HANS_PASSWORD&#x27;]) . &#x27;,password-flags=1&quot;&#x27;, $output, $retval);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 124, <strong>Function:</strong> exec</p>
    <div class="context-code">        exec(&#x27;nmcli connection add type vpn con-name hans-icmp-vpn ifname tun0 vpn-type org.freedesktop.NetworkManager.hans&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to create Hans connection&#x27;);<br>        }<br><br>        exec(&#x27;nmcli connection modify hans-icmp-vpn vpn.data &quot;server=&#x27; . escapeshellarg($env[&#x27;HANS_SERVER&#x27;]) . &#x27;,password=&#x27; . escapeshellarg($env[&#x27;HANS_PASSWORD&#x27;]) . &#x27;,password-flags=1&quot;&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to configure Hans connection&#x27;);<br>        }<br><br>        exec(&#x27;nmcli connection modify hans-icmp-vpn ipv4.method auto ipv4.never-default true&#x27;, $output, $retval);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 129, <strong>Function:</strong> exec</p>
    <div class="context-code">        exec(&#x27;nmcli connection modify hans-icmp-vpn vpn.data &quot;server=&#x27; . escapeshellarg($env[&#x27;HANS_SERVER&#x27;]) . &#x27;,password=&#x27; . escapeshellarg($env[&#x27;HANS_PASSWORD&#x27;]) . &#x27;,password-flags=1&quot;&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to configure Hans connection&#x27;);<br>        }<br><br>        exec(&#x27;nmcli connection modify hans-icmp-vpn ipv4.method auto ipv4.never-default true&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to configure Hans IPv4 settings&#x27;);<br>        }<br><br>        exec(&#x27;nmcli connection modify hans-icmp-vpn ipv6.method auto ipv6.addr-gen-mode default&#x27;, $output, $retval);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 134, <strong>Function:</strong> exec</p>
    <div class="context-code">        exec(&#x27;nmcli connection modify hans-icmp-vpn ipv4.method auto ipv4.never-default true&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to configure Hans IPv4 settings&#x27;);<br>        }<br><br>        exec(&#x27;nmcli connection modify hans-icmp-vpn ipv6.method auto ipv6.addr-gen-mode default&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to configure Hans IPv6 settings&#x27;);<br>        }<br><br>        $results[&#x27;connections&#x27;][] = &#x27;Hans ICMP VPN configured successfully&#x27;;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 145, <strong>Function:</strong> exec</p>
    <div class="context-code">    }<br><br>    // Process WiFi AP configuration<br>    if (isset($env[&#x27;WIFI_SSID&#x27;]) &amp;&amp; isset($env[&#x27;WIFI_PASSWORD&#x27;])) {<br>        // Delete existing connection if present<br>        exec(&#x27;nmcli connection delete pi_hotspot 2&gt;/dev/null&#x27;);<br><br>        // Create new connection<br>        $output = [];<br>        $retval = 0;<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 151, <strong>Function:</strong> exec</p>
    <div class="context-code"><br>        // Create new connection<br>        $output = [];<br>        $retval = 0;<br><br>        exec(&#x27;nmcli con add type wifi ifname wlan0 con-name pi_hotspot autoconnect yes ssid &quot;&#x27; . escapeshellarg($env[&#x27;WIFI_SSID&#x27;]) . &#x27;&quot;&#x27;, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to create WiFi AP connection&#x27;);<br>        }<br><br>        $wifiCmd = &#x27;nmcli con mod pi_hotspot &#x27; .</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php, <strong>Line:</strong> 166, <strong>Function:</strong> exec</p>
    <div class="context-code">            &#x27;ipv4.addresses 192.168.4.1/24 &#x27; .<br>            &#x27;ipv4.method shared &#x27; .<br>            &#x27;ipv4.never-default yes &#x27; .<br>            &#x27;ipv6.method ignore&#x27;;<br><br>        exec($wifiCmd, $output, $retval);<br>        if ($retval !== 0) {<br>            throw new Exception(&#x27;Failed to configure WiFi AP settings&#x27;);<br>        }<br><br>        $results[&#x27;connections&#x27;][] = &#x27;WiFi Access Point configured successfully&#x27;;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/shutdown.php, <strong>Line:</strong> 17, <strong>Function:</strong> exec</p>
    <div class="context-code">if ($_SERVER[&#x27;REQUEST_METHOD&#x27;] === &#x27;POST&#x27;) {<br>    // CSRF check is already handled by bootstrap.php<br>}<br><br>// Execute shutdown command<br>exec(&#x27;sudo /sbin/poweroff 2&gt;&amp;1&#x27;, $output, $return_var);<br><br>if ($return_var === 0) {<br>    echo json_encode([&#x27;success&#x27; =&gt; true, &#x27;message&#x27; =&gt; &#x27;System is shutting down...&#x27;]);<br>} else {<br>    error_log(&quot;Shutdown failed. Output: &quot; . implode(&quot;\n&quot;, $output));</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/run-script.php, <strong>Line:</strong> 45, <strong>Function:</strong> exec</p>
    <div class="context-code">    case &#x27;check.py&#x27;:<br>        // Run check.py with no parameters<br>        if (!is_executable($script_path)) {<br>            die(&#x27;Error: Script is not executable&#x27;);<br>        }<br>        exec($script_path . &#x27; 2&gt;&amp;1&#x27;, $output, $return_var);<br>        if ($return_var !== 0) {<br>            die(&#x27;Error: Script execution failed with code &#x27; . $return_var);<br>        }<br>        break;<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/run-script.php, <strong>Line:</strong> 68, <strong>Function:</strong> exec</p>
    <div class="context-code"><br>        // Run nmap.sh with parameters<br>        if (!is_executable($script_path)) {<br>            die(&#x27;Error: Script is not executable&#x27;);<br>        }<br>        exec($script_path . &#x27; &#x27; . $host . &#x27; &#x27; . $range . &#x27; 2&gt;&amp;1&#x27;, $output, $return_var);<br>        if ($return_var !== 0) {<br>            die(&#x27;Error: Script execution failed with code &#x27; . $return_var);<br>        }<br>        break;<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/run-script.php, <strong>Line:</strong> 88, <strong>Function:</strong> exec</p>
    <div class="context-code">        // Sanitize parameters<br>        $domain = escapeshellarg($domain);<br>        $type = escapeshellarg($type);<br><br>        // Run dig command<br>        exec(&quot;dig $type $domain +short 2&gt;&amp;1&quot;, $output, $return_var);<br>        if ($return_var !== 0) {<br>            die(&#x27;Error: dig command failed with code &#x27; . $return_var);<br>        }<br>        break;<br>}</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/upload.php, <strong>Line:</strong> 111, <strong>Function:</strong> file_get_contents</p>
    <div class="context-code">    $isTextFile = false;<br>    if (strpos($mimeType, &#x27;text/&#x27;) === 0) {<br>        $isTextFile = true;<br>    } elseif ($mimeType === &#x27;application/octet-stream&#x27;) {<br>        // For .ovpn and other text files sometimes detected as octet-stream<br>        $content = file_get_contents($file[&#x27;tmp_name&#x27;]);<br>        if (mb_detect_encoding($content, &#x27;ASCII, UTF-8&#x27;, true)) {<br>            $isTextFile = true;<br>        }<br>    }<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/upload.php, <strong>Line:</strong> 133, <strong>Function:</strong> mkdir</p>
    <div class="context-code">    switch ($type) {<br>        case &#x27;passwords&#x27;:<br>            // Save to wordlists directory<br>            $destination = $typeConfig[&#x27;dir&#x27;] . &#x27;/&#x27; . basename($file[&#x27;name&#x27;]);<br>            if (!is_dir($typeConfig[&#x27;dir&#x27;])) {<br>                mkdir($typeConfig[&#x27;dir&#x27;], 0755, true);<br>            }<br><br>            if (!move_uploaded_file($file[&#x27;tmp_name&#x27;], $destination)) {<br>                throw new Exception(&#x27;Failed to save file&#x27;);<br>            }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/upload.php, <strong>Line:</strong> 136, <strong>Function:</strong> move_uploaded_file</p>
    <div class="context-code">            $destination = $typeConfig[&#x27;dir&#x27;] . &#x27;/&#x27; . basename($file[&#x27;name&#x27;]);<br>            if (!is_dir($typeConfig[&#x27;dir&#x27;])) {<br>                mkdir($typeConfig[&#x27;dir&#x27;], 0755, true);<br>            }<br><br>            if (!move_uploaded_file($file[&#x27;tmp_name&#x27;], $destination)) {<br>                throw new Exception(&#x27;Failed to save file&#x27;);<br>            }<br><br>            // Set permissions<br>            chmod($destination, 0644);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/upload.php, <strong>Line:</strong> 149, <strong>Function:</strong> move_uploaded_file</p>
    <div class="context-code"><br>        case &#x27;env-secrets&#x27;:<br>            // Save to /var/www with specific name<br>            $destination = &#x27;/var/www/env-secrets&#x27;;<br><br>            if (!move_uploaded_file($file[&#x27;tmp_name&#x27;], $destination)) {<br>                throw new Exception(&#x27;Failed to save file&#x27;);<br>            }<br><br>            // Set restrictive permissions - only readable by www-data<br>            chmod($destination, 0600);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/upload.php, <strong>Line:</strong> 162, <strong>Function:</strong> move_uploaded_file</p>
    <div class="context-code"><br>        case &#x27;vpn&#x27;:<br>            // Save to /var/www with fixed name for OpenVPN<br>            $destination = &#x27;/var/www/openvpn-udp.ovpn&#x27;;<br><br>            if (!move_uploaded_file($file[&#x27;tmp_name&#x27;], $destination)) {<br>                throw new Exception(&#x27;Failed to save file&#x27;);<br>            }<br><br>            // Set restrictive permissions - only readable by www-data<br>            chmod($destination, 0600);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/ping-stream.php, <strong>Line:</strong> 17, <strong>Function:</strong> ini_set</p>
    <div class="context-code">if (!isset($_SESSION[&#x27;logged_in&#x27;]) || !$_SESSION[&#x27;logged_in&#x27;]) {<br>    http_response_code(401);<br>    die(&#x27;data: Unauthorized, please login first&#x27; . &quot;\n\n&quot; . &quot;event: done\ndata: \n\n&quot;);<br>}<br><br>@ini_set(&#x27;output_buffering&#x27;, &#x27;off&#x27;);<br>@ini_set(&#x27;zlib.output_compression&#x27;, false);<br>while (ob_get_level() &gt; 0) ob_end_flush();<br>ob_implicit_flush(true);<br><br>header(&#x27;Content-Type: text/event-stream&#x27;);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/ping-stream.php, <strong>Line:</strong> 18, <strong>Function:</strong> ini_set</p>
    <div class="context-code">    http_response_code(401);<br>    die(&#x27;data: Unauthorized, please login first&#x27; . &quot;\n\n&quot; . &quot;event: done\ndata: \n\n&quot;);<br>}<br><br>@ini_set(&#x27;output_buffering&#x27;, &#x27;off&#x27;);<br>@ini_set(&#x27;zlib.output_compression&#x27;, false);<br>while (ob_get_level() &gt; 0) ob_end_flush();<br>ob_implicit_flush(true);<br><br>header(&#x27;Content-Type: text/event-stream&#x27;);<br>header(&#x27;Cache-Control: no-cache&#x27;);</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/ping-stream.php, <strong>Line:</strong> 27, <strong>Function:</strong> preg_replace</p>
    <div class="context-code">header(&#x27;Content-Type: text/event-stream&#x27;);<br>header(&#x27;Cache-Control: no-cache&#x27;);<br>header(&#x27;X-Accel-Buffering: no&#x27;);<br>header(&#x27;Content-Encoding: none&#x27;);<br><br>$ssid = isset($_GET[&#x27;ssid&#x27;]) ? preg_replace(&#x27;/[^a-zA-Z0-9 _\-\.]/&#x27;, &#x27;&#x27;, $_GET[&#x27;ssid&#x27;]) : &#x27;&#x27;;<br>if (!$ssid) {<br>    echo &quot;data: No SSID selected\n\n&quot;;<br>    echo &quot;event: done\ndata: \n\n&quot;;<br>    flush(); if (function_exists(&#x27;ob_flush&#x27;)) ob_flush();<br>    exit;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/ping-stream.php, <strong>Line:</strong> 37, <strong>Function:</strong> popen</p>
    <div class="context-code">    exit;<br>}<br><br>$cmd = &#x27;/var/www/html/wifi-scan.sh &#x27; . escapeshellarg($ssid);<br><br>$proc = popen($cmd . &quot; 2&gt;&amp;1&quot;, &quot;r&quot;);<br>if (!$proc) {<br>    echo &quot;data: Failed to start process\n\n&quot;;<br>    echo &quot;event: done\ndata: \n\n&quot;;<br>    flush(); if (function_exists(&#x27;ob_flush&#x27;)) ob_flush();<br>    exit;</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/DEV/ping-stream.php, <strong>Line:</strong> 14, <strong>Function:</strong> ini_set</p>
    <div class="context-code">/* ── HTTP &amp; PHP streaming headers ─────────────────────────────── */<br>header(&#x27;Content-Type: text/event-stream&#x27;);<br>header(&#x27;Cache-Control: no-cache&#x27;);<br>header(&#x27;X-Accel-Buffering: no&#x27;);      // nginx: disable buffering<br><br>ini_set(&#x27;output_buffering&#x27;, &#x27;0&#x27;);<br>ini_set(&#x27;zlib.output_compression&#x27;, &#x27;0&#x27;);<br>set_time_limit(0);<br>while (ob_get_level()) ob_end_flush();<br>ob_implicit_flush(true);<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/DEV/ping-stream.php, <strong>Line:</strong> 15, <strong>Function:</strong> ini_set</p>
    <div class="context-code">header(&#x27;Content-Type: text/event-stream&#x27;);<br>header(&#x27;Cache-Control: no-cache&#x27;);<br>header(&#x27;X-Accel-Buffering: no&#x27;);      // nginx: disable buffering<br><br>ini_set(&#x27;output_buffering&#x27;, &#x27;0&#x27;);<br>ini_set(&#x27;zlib.output_compression&#x27;, &#x27;0&#x27;);<br>set_time_limit(0);<br>while (ob_get_level()) ob_end_flush();<br>ob_implicit_flush(true);<br><br>/* ── Send an “init” comment so the browser knows we’re connected ─ */</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/DEV/ping-stream.php, <strong>Line:</strong> 26, <strong>Function:</strong> shell_exec</p>
    <div class="context-code">echo &quot;: init\n\n&quot;; flush();<br><br>/* ── Build the ping command ───────────────────────────────────── */<br>$pingBin = &#x27;/bin/ping&#x27;;                     // full path avoids $PATH issues<br>$pingCmd = &quot;$pingBin -n -c 5 8.8.8.8&quot;;      // numeric output, 5 probes<br>$cmd     = (shell_exec(&#x27;command -v stdbuf&#x27;) ? &quot;stdbuf -oL -eL &quot; : &#x27;&#x27;) . $pingCmd;<br><br>/* ── Launch subprocess with correct pipe directions ───────────── */<br>$proc = proc_open(<br>    $cmd,<br>    [</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/DEV/ping-stream.php, <strong>Line:</strong> 29, <strong>Function:</strong> proc_open</p>
    <div class="context-code">$pingBin = &#x27;/bin/ping&#x27;;                     // full path avoids $PATH issues<br>$pingCmd = &quot;$pingBin -n -c 5 8.8.8.8&quot;;      // numeric output, 5 probes<br>$cmd     = (shell_exec(&#x27;command -v stdbuf&#x27;) ? &quot;stdbuf -oL -eL &quot; : &#x27;&#x27;) . $pingCmd;<br><br>/* ── Launch subprocess with correct pipe directions ───────────── */<br>$proc = proc_open(<br>    $cmd,<br>    [<br>        0 =&gt; [&#x27;pipe&#x27;, &#x27;r&#x27;],     // child stdin  (unused)<br>        1 =&gt; [&#x27;pipe&#x27;, &#x27;w&#x27;],     // child stdout → PHP reads<br>        2 =&gt; [&#x27;pipe&#x27;, &#x27;w&#x27;],     // child stderr → PHP reads</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 17, <strong>Function:</strong> exec</p>
    <div class="context-code">        $wifi_list = [];<br>        putenv(&#x27;LANG=en_US.UTF-8&#x27;);<br>        setlocale(LC_ALL, &#x27;en_US.UTF-8&#x27;);<br><br>        // ask nmcli to back-slash-escape any colons it finds *inside* fields<br>        exec(&quot;LANG=en_US.UTF-8 nmcli -t --escape yes -f IN-USE,BSSID,SSID,SECURITY,SIGNAL dev wifi list&quot;, $lines);<br><br>        foreach ($lines as $line) {<br>            // at minimum: *,BSSID(6 parts),SSID,SECURITY,SIGNAL → 9 fields<br>            $parts = explode(&#x27;:&#x27;, $line);<br>            if (count($parts) &lt; 9) {</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 58, <strong>Function:</strong> exec</p>
    <div class="context-code">    public function getTopBarInterfaces()<br>    {<br>        $interfaces = [];<br><br>        // Get interface states from NetworkManager<br>        exec(&quot;nmcli -t -f DEVICE,TYPE,STATE,CONNECTION device&quot;, $nm_lines);<br>        $nm_info = [];<br>        foreach ($nm_lines as $line) {<br>            $parts = explode(&#x27;:&#x27;, $line);<br>            if (count($parts) &gt;= 4) {<br>                $nm_info[$parts[0]] = [</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 72, <strong>Function:</strong> exec</p>
    <div class="context-code">                ];<br>            }<br>        }<br><br>        // Get IP addresses<br>        exec(&quot;ip -br addr&quot;, $ip_lines);<br>        foreach ($ip_lines as $line) {<br>            $parts = preg_split(&#x27;/\s+/&#x27;, trim($line), 4);<br>            if (count($parts) &gt;= 2) {<br>                $iface = $parts[0];<br></div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 141, <strong>Function:</strong> exec</p>
    <div class="context-code">    }<br><br>    public function getSavedConnections()<br>    {<br>        $saved_connections = [];<br>        exec(&quot;nmcli -t -f NAME,UUID,TYPE,DEVICE connection show&quot;, $lines);<br>        foreach ($lines as $line) {<br>            $parts = explode(&#x27;:&#x27;, $line, 4);<br>            if (count($parts) === 4) {<br>                $saved_connections[] = [<br>                    &#x27;name&#x27;   =&gt; $parts[0],</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 162, <strong>Function:</strong> exec</p>
    <div class="context-code">    {<br>        $iface_status = [];<br><br>        // Get all devices if no specific interfaces are requested<br>        if ($interfaces === null) {<br>            exec(&quot;nmcli -t -f DEVICE device status&quot;, $devices);<br>            $interfaces = array_map(&#x27;trim&#x27;, $devices);<br>        }<br><br>        foreach ($interfaces as $if) {<br>            $iface_status[$if] = [</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 178, <strong>Function:</strong> exec</p>
    <div class="context-code">                &#x27;mac&#x27;            =&gt; &#x27;&#x27;<br>            ];<br><br>            // Get device state and connection info<br>            $stateLine = [];<br>            exec(&quot;nmcli -t -f DEVICE,STATE,CONNECTION device status | grep ^$if:&quot;, $stateLine);<br>            if (!empty($stateLine)) {<br>                $fields = explode(&#x27;:&#x27;, $stateLine[0]);<br>                if (count($fields) &gt;= 3) {<br>                    $iface_status[$if][&#x27;state&#x27;] = $fields[1];<br>                    if ($fields[2] !== &quot;--&quot;) {</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 186, <strong>Function:</strong> exec</p>
    <div class="context-code">                if (count($fields) &gt;= 3) {<br>                    $iface_status[$if][&#x27;state&#x27;] = $fields[1];<br>                    if ($fields[2] !== &quot;--&quot;) {<br>                        $iface_status[$if][&#x27;connection&#x27;] = $fields[2];<br>                        // Get connection type for active connections<br>                        exec(&quot;nmcli -t -f TYPE connection show &quot; . escapeshellarg($fields[2]), $typeLine);<br>                        if (!empty($typeLine)) {<br>                            $iface_status[$if][&#x27;connection_type&#x27;] = trim($typeLine[0]);<br>                        }<br>                    }<br>                }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 196, <strong>Function:</strong> exec</p>
    <div class="context-code">                }<br>            }<br><br>            // Get IP address<br>            $ipLine = [];<br>            exec(&quot;nmcli -t -f IP4.ADDRESS dev show $if | grep IP4.ADDRESS&quot;, $ipLine);<br>            if (!empty($ipLine)) {<br>                $addr = explode(&#x27;:&#x27;, $ipLine[0]);<br>                if (isset($addr[1])) {<br>                    $iface_status[$if][&#x27;ip&#x27;] = explode(&#x27;/&#x27;, $addr[1])[0];<br>                }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 208, <strong>Function:</strong> exec</p>
    <div class="context-code"><br>            // Get connection method (DHCP/Static)<br>            if ($iface_status[$if][&#x27;connection&#x27;] !== &#x27;&#x27;) {<br>                $methLine = [];<br>                $conn_name_arg = escapeshellarg($iface_status[$if][&#x27;connection&#x27;]);<br>                exec(&quot;nmcli -t -f ipv4.method connection show $conn_name_arg&quot;, $methLine);<br>                if (!empty($methLine)) {<br>                    $methodVal = trim($methLine[0]);<br>                    $iface_status[$if][&#x27;method&#x27;] = (strpos($methodVal, &#x27;manual&#x27;) !== false) ? &#x27;Static&#x27; : &#x27;DHCP&#x27;;<br>                }<br>            }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 217, <strong>Function:</strong> exec</p>
    <div class="context-code">                }<br>            }<br><br>            // Get MAC address<br>            $macLine = [];<br>            exec(&quot;nmcli -t -f GENERAL.HWADDR dev show $if | grep GENERAL.HWADDR&quot;, $macLine);<br>            if (!empty($macLine)) {<br>                $macParts = explode(&#x27;:&#x27;, $macLine[0], 2);<br>                if (isset($macParts[1])) {<br>                    $iface_status[$if][&#x27;mac&#x27;] = trim($macParts[1]);<br>                }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php, <strong>Line:</strong> 231, <strong>Function:</strong> exec</p>
    <div class="context-code">    }<br><br>    public function getActiveConnectionUuids()<br>    {<br>        $active_uuids = [];<br>        exec(&quot;nmcli -t -f UUID connection show --active&quot;, $out);<br>        foreach ($out as $line) {<br>            $active_uuids[] = trim($line);<br>        }<br>        return $active_uuids;<br>    }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Util.php, <strong>Line:</strong> 18, <strong>Function:</strong> curl_exec</p>
    <div class="context-code">        $ch = curl_init();<br>        curl_setopt($ch, CURLOPT_URL, &#x27;https://ifconfig.me&#x27;);<br>        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);<br>        curl_setopt($ch, CURLOPT_TIMEOUT, 2);<br>        curl_setopt($ch, CURLOPT_USERAGENT, &#x27;curl&#x27;);<br>        $ip = trim(curl_exec($ch));<br>        $httpcode = curl_getinfo($ch, CURLINFO_HTTP_CODE);<br>        curl_close($ch);<br>        if (filter_var($ip, FILTER_VALIDATE_IP) &amp;&amp; $httpcode === 200) {<br>            return $ip;<br>        }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Util.php, <strong>Line:</strong> 35, <strong>Function:</strong> exec</p>
    <div class="context-code">     * @return bool True if DNS works<br>     */<br>    public static function dnsResolvesGoogle() {<br>        $output = null;<br>        $retval = null;<br>        exec(&#x27;dig +short google.com&#x27;, $output, $retval);<br>        foreach ($output as $line) {<br>            if (filter_var($line, FILTER_VALIDATE_IP)) {<br>                return true;<br>            }<br>        }</div>
</div>
<div class="occurrence-item">
    <p><strong>File:</strong> haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Util.php, <strong>Line:</strong> 52, <strong>Function:</strong> exec</p>
    <div class="context-code">     * @return bool True if ping works<br>     */<br>    public static function pingGoogle() {<br>        $output = [];<br>        $retval = -1;<br>        exec(&#x27;ping -c 1 -W 1 8.8.8.8 2&gt;/dev/null&#x27;, $output, $retval);<br>        if ($retval === 0) {<br>            return true;<br>        }<br>        return false;<br>    }</div>
</div>

            </div>

            <!-- Summary Section -->
            <div class="config-section">
                <div class="config-title">Summary</div>
                <div class="config-description">Summary of scanned files and incidents.</div>
                <p><strong>Total files scanned:</strong> 23</p>
                <p><strong>Total incidents:</strong> 91</p>
                <p><strong>Files with incidents:</strong></p>
                <ul>
                    <li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/DEV/ping-stream.php: 4 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/apply_config.php: 17 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/ping-stream.php: 4 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/run-script.php: 3 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/shutdown.php: 1 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/api/upload.php: 5 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/configure.php: 1 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Data.php: 11 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/data/Util.php: 3 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Network.php: 12 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/network/Tunnel.php: 20 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/security/SecureCommand.php: 1 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/security/bootstrap.php: 3 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/ui/UI.php: 2 incident(s)</li><li>haxinator-pigen-overlay/stage2/02-custom-config/root_files/html/ui/diagnostic-status.php: 4 incident(s)</li>
                </ul>
            </div>

            <!-- Table Section -->
            <div class="config-section">
                <div class="config-title">Dangerous Functions by File</div>
                <div class="config-description">Table showing incidents per function across files.</div>
                <div class="table-responsive">
                <table class="nm-table table">
                    <thead>
                        <tr>
                            <th scope="col" style="min-width: 200px; width: 30%;">File</th>
                            <th scope="col" style="min-width: 80px; width: 5%;">curl_exec</th><th scope="col" style="min-width: 80px; width: 5%;">exec</th><th scope="col" style="min-width: 80px; width: 5%;">file_get_c...</th><th scope="col" style="min-width: 80px; width: 5%;">file_put_c...</th><th scope="col" style="min-width: 80px; width: 5%;">fsockopen</th><th scope="col" style="min-width: 80px; width: 5%;">getenv</th><th scope="col" style="min-width: 80px; width: 5%;">ini_get</th><th scope="col" style="min-width: 80px; width: 5%;">ini_set</th><th scope="col" style="min-width: 80px; width: 5%;">mkdir</th><th scope="col" style="min-width: 80px; width: 5%;">move_uploa...</th><th scope="col" style="min-width: 80px; width: 5%;">ob_start</th><th scope="col" style="min-width: 80px; width: 5%;">popen</th><th scope="col" style="min-width: 80px; width: 5%;">preg_repla...</th><th scope="col" style="min-width: 80px; width: 5%;">proc_open</th><th scope="col" style="min-width: 80px; width: 5%;">shell_exec</th><th scope="col" style="min-width: 80px; width: 5%;">unlink</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>2</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>1</td><td style='background: #ffcccc;'>1</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style='background: #ff3333;'>16</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>1</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>2</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>1</td><td style='background: #ffcccc;'>1</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style='background: #ffcccc;'>3</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style='background: #ffcccc;'>1</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>1</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>1</td><td style='background: #ffcccc;'>3</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>1</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style='background: #ff6666;'>11</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style='background: #ffcccc;'>1</td><td style='background: #ffcccc;'>2</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style='background: #ff6666;'>12</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style='background: #ffcccc;'>2</td><td style='background: #ffcccc;'>4</td><td style='background: #ffcccc;'>2</td><td style='background: #ffcccc;'>3</td><td style='background: #ffcccc;'>2</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>2</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>2</td><td style=''>0</td><td style='background: #ffcccc;'>3</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style='background: #ffcccc;'>1</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>3</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>2</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>
<tr>
    <td>haxinator-pigen-overlay/stag</td>
    <td style='background: #ffcccc;'>1</td><td style='background: #ffcccc;'>2</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style='background: #ffcccc;'>1</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td><td style=''>0</td>
</tr>

                    </tbody>
                </table>
            </div>
        </div>
        <div class="footer">Generated on 2025-05-18 17:12:42</div>
    </div>

    <script src="/js/bootstrap.bundle.min.js"></script>
</body>
</html>
